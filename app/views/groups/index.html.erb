<div class="row-fluid">
  <div class="span12">
    <section class="viewblock">
      <header class="viewblock-header">
        <h1 class="default-padding">
          <%= t(:all_groups) %>
          <% if can? :create, Group %>
            <%= link_to t(:new_group), new_group_path, :class => "button" %>
          <% end %>
        </h1>
      </header>
      <div class="viewblock-cont">
        <% if !@my_groups.empty? %>
          <div class="subnav clearfix">
            <h4><%= t(:my_groups) %></h4>
          </div>
          <ul class="list-stacked">
            <% @my_groups.each do |group| %>
              <li>
                <h3>
                  <%= link_to group.name, group, :class => "link-hl" %>
                  <% if can? :update, group %>
                    <small><%= link_to t(:edit), edit_group_path(group) %></small>
                  <% end %>
                  <% if can? :delete, group %>
                    <small><%= link_to t(:destroy), group, :data => { :confirm => t(:are_you_sure) }, :method => :delete %></small>
                  <% end %>                  
                </h3>
                <%= link_to t(:join), group_memberships_path(:group_id => group.id, :membership => {:user_id => current_user.id}), :method => :post if user_signed_in? & !group.made_request?(current_user) %></td>
                <p class="indented">
                  <% member_list(group) %>
                </p>
              </li>
            <% end %>
          </ul>
        <% end %>
        <% other_groups = @groups - @my_groups %>
        <% if !other_groups.empty? %>
          <div class="subnav clearfix">
            <h4><%= t(:other_groups) %></h4>
          </div>
          <ul class="list-stacked">
            <% other_groups.each do |group| %>
              <li>
                <h3>
                  <%= link_to group.name, group, :class => "link-hl" %>
                  <% if can? :update, group %>
                    <small><%= link_to t(:edit), edit_group_path(group) %></small>
                  <% end %>
                  <% if can? :delete, group %>
                    <small><%= link_to t(:destroy), group, :data => { :confirm => t(:are_you_sure) }, :method => :delete %></small>
                  <% end %>                       
                </h3>
                <%= link_to t(:join), group_memberships_path(:group_id => group.id, :membership => {:user_id => current_user.id}), :method => :post if user_signed_in? & !group.made_request?(current_user) %></td>
                <p class="indented">
                  <% member_list(group) %>
                </p>
              </li>
            <% end %>
          </ul>
        <% end %>

        
      </div>
    </section>
  </div>

</div>
